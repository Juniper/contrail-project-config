---
- hosts: builder
  roles:
    - fetch-packages

- hosts: localhost
  roles:
    - contrail-common-libs2
    - role: publish-rpm-nexus
      remote_repo_path: '{{ nexus.repos.yum_tpc }}/{{ zuul.branch }}/source'
      when: zuul.pipeline == 'post-merge'
    - role: publish-rpm-nexus
      remote_repo_path: "{{ nexus.repos.yum-tungsten-tpc }}/{{ packaging.repo_names[hostvars['builder'].ansible_distribution] }}"
      when: zuul.pipeline == 'experimental'
